---
output: 
  html_document: 
    keep_md: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(cache=TRUE)
```
#Data Science Using R
##2 - R Programming

###0) R version used
```{r}
print(R.version.string)
```

###1) basic datatypes: input/eval/Robject/vectorlists/matrix/factors
```{r}
print(1:20)
print(1+2i)
print(c(TRUE,"a"))
x<-list(1,"a",TRUE,1+4i)
print(x)
m<-matrix(nrow=2,ncol=3)
print(m)
dim(m)
print(matrix(1:8,nrow=2,ncol=4))
num<-1:10
dim(num)<-c(5,2)
print(num)
cbind(1:3,10:12)
rbind(1:3,10:12)
x<-factor(c("yes","yes","no","yes","no"))
x
table(x)
unclass(x)
y<-factor(c("yes","yes","no","yes","no"), levels=c("yes","no"))
y
x<-c(1,2,NA,3)
is.na(x)
y<-c(1,2,NaN,NA,6)
is.na(y)
is.nan(y)
x<-data.frame(foo=1:4,bar=c(T,T,F,F))
x
print(paste("nrow:", nrow(x),", ncol:",ncol(x)))
x<-1:3
names(x)
names(x)<-c("foo","bar","norf")
names(x)
x<-list(a=1,b=2,c=3)
x
m<-matrix(1:4,nrow=2,ncol=3)
dimnames(m)<-list(c("a","b"),c("c","d","e"))
m
```

###2) basic reading: read.table/dput/dget/dump/source/
```{r}
data<-read.table("foo.txt")
data
foo<-read.table(file="test.txt",header=TRUE,sep="\n",nrows=3)
foo
# passing adata around by deparsing R object using dput
# and reading back using dget
y<-data.frame(a=1,b="a")
#dput(y)
dput(y,file="y.R") # actually creates physical y.R
new.y<-dget("y.R")
new.y
x<-"foo"
y<-data.frame(a=1, b="a")
dump(c("x","y"),file="data.R") # creates physical data.R
rm(x,y)
source("data.R")
y
x
```

###3) basic connections: file/readLines/writeLines/url
```{r}
con<-file("HMP_16s_single_cell_MDA_from_fecal_specimens-short.txt","r")
x<-readLines(con,100)
x
out<-file("test-output.txt","w")
writeLines(text = x,con = out)
close(con)
close(out)
con<-url("http://www.google.com","r")
x<-readLines(con)
head(x,1)
close(con)
```

###4) basic subsetting: vector/list/matrix/partial-matching/removing-NA-values
```{r}
x<-c("a","b","c","d","e")
x[1:4]
x[x>"b"]
y<-list(foo=1:4,bar=c(0.6,0.4,0.2),baz=TRUE,bad=list(4,3,2,1))
y[[2]]
y$bar
y[["bar"]]
y[["bad"]][[3]]
m<-matrix(1:6,2,3)
m
m[1,2] #m[row,col]
m[1,] #m entire row=1
m[1,,drop=FALSE] # if drop=FALSE, the 1x1 matrix is maintained
x<-list(aardvark=1:5)
x[["aard",exact=FALSE]] # if exact=FALSE, partial matching is ok
x<-c(1,2,NA,4,NA,5)
x[!is.na(x)]
y<-c("a","b",NA,"d",NA,NA)
x[complete.cases(x,y)]
y[complete.cases(x,y)]
airquality[1:10,]
airquality[complete.cases(airquality),][1:10,]
```

###5) basic vectorized operations
```{r}
x<-1:4;y<-6:9
x*y
x<-matrix(1:4,2,2);y<-matrix(rep(10,4),2,2)
x*y # element-wise multiplication
x%*%y # true matrix multiplication
y%*%x
```

###6) basic control structures: if-else/for/while/repeat
```{r}
x<-5;y<-7
if(x>y) {
    print("x is bigger than y")
} else if(x<y) {
    print("y is bigger than x")
} else {
    print("x and y are same")
}
z<- if(x>3) {
    10
} else {
    30
}
z
for(i in 4:1) {
    print(i)
}
x<-c("d","c","b","a")
for(i in 1:4){ print(x[i]) } # 1 of 3 ways to achieve similar result
for(i in seq_along(x)){ print(x[i]) } # 1 of 3 ways to achieve similar result
for(letter in x) { print(letter) } # 1 of 3 ways to achieve similar result
x<-matrix(1:6,2,3)
x
# nested for-loop
for(i in seq_len(nrow(x))) {
    for(j in seq_len(ncol(x))) {
        print(x[i,j])
    }
}
count<-0
while(count<10) {
    print(count)
    count<-count+1
}
z<-5
while(z>=3 && z<=10) {
    print(z)
    coin<-rbinom(1,1,0.5)
    if(coin==1) { # random coin toss-up
        z<-z+1
    } else {
        z<-z-1
    }
}
x0<-1
i<-0
repeat{ #infinite while(TRUE) loop
    i<-i+1
    x1<-rnorm(1)
    if(abs(x1-x0)>6) {
        print(abs(x1-x0))
        print(i)
        break
    } else {
        x0<-x1
    }
}
for(i in 1:100) {
    if(i<=90) { # skip from 1 to 90
        next
    }
    print(i)
}
```

###7) basic functions
```{r}
above<-function(x,n) {
    use<-x>n
    x[use]
}
above(1:20,12)
colmeans<-function(y) {
    nc<-ncol(y)
    means<-numeric(nc)
    for(i in 1:nc){
        #means[i]<-mean(y[,i])
        means[i]<-mean(y[,i][!is.na(y[,i])])
    }
    means
}
colmeans(airquality)
```