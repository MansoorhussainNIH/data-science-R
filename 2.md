
#Data Science Using R
##2 - R Programming

###0) R version used

```r
print(R.version.string)
```

```
## [1] "R version 3.2.3 (2015-12-10)"
```

###1) basic datatypes: input/eval/Robject/vectorlists/matrix/factors

```r
print(1:20)
```

```
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
```

```r
print(1+2i)
```

```
## [1] 1+2i
```

```r
print(c(TRUE,"a"))
```

```
## [1] "TRUE" "a"
```

```r
x<-list(1,"a",TRUE,1+4i)
print(x)
```

```
## [[1]]
## [1] 1
## 
## [[2]]
## [1] "a"
## 
## [[3]]
## [1] TRUE
## 
## [[4]]
## [1] 1+4i
```

```r
m<-matrix(nrow=2,ncol=3)
print(m)
```

```
##      [,1] [,2] [,3]
## [1,]   NA   NA   NA
## [2,]   NA   NA   NA
```

```r
dim(m)
```

```
## [1] 2 3
```

```r
print(matrix(1:8,nrow=2,ncol=4))
```

```
##      [,1] [,2] [,3] [,4]
## [1,]    1    3    5    7
## [2,]    2    4    6    8
```

```r
num<-1:10
dim(num)<-c(5,2)
print(num)
```

```
##      [,1] [,2]
## [1,]    1    6
## [2,]    2    7
## [3,]    3    8
## [4,]    4    9
## [5,]    5   10
```

```r
cbind(1:3,10:12)
```

```
##      [,1] [,2]
## [1,]    1   10
## [2,]    2   11
## [3,]    3   12
```

```r
rbind(1:3,10:12)
```

```
##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]   10   11   12
```

```r
x<-factor(c("yes","yes","no","yes","no"))
x
```

```
## [1] yes yes no  yes no 
## Levels: no yes
```

```r
table(x)
```

```
## x
##  no yes 
##   2   3
```

```r
unclass(x)
```

```
## [1] 2 2 1 2 1
## attr(,"levels")
## [1] "no"  "yes"
```

```r
y<-factor(c("yes","yes","no","yes","no"), levels=c("yes","no"))
y
```

```
## [1] yes yes no  yes no 
## Levels: yes no
```

```r
x<-c(1,2,NA,3)
is.na(x)
```

```
## [1] FALSE FALSE  TRUE FALSE
```

```r
y<-c(1,2,NaN,NA,6)
is.na(y)
```

```
## [1] FALSE FALSE  TRUE  TRUE FALSE
```

```r
is.nan(y)
```

```
## [1] FALSE FALSE  TRUE FALSE FALSE
```

```r
x<-data.frame(foo=1:4,bar=c(T,T,F,F))
x
```

```
##   foo   bar
## 1   1  TRUE
## 2   2  TRUE
## 3   3 FALSE
## 4   4 FALSE
```

```r
print(paste("nrow:", nrow(x),", ncol:",ncol(x)))
```

```
## [1] "nrow: 4 , ncol: 2"
```

```r
x<-1:3
names(x)
```

```
## NULL
```

```r
names(x)<-c("foo","bar","norf")
names(x)
```

```
## [1] "foo"  "bar"  "norf"
```

```r
x<-list(a=1,b=2,c=3)
x
```

```
## $a
## [1] 1
## 
## $b
## [1] 2
## 
## $c
## [1] 3
```

```r
m<-matrix(1:4,nrow=2,ncol=3)
```

```
## Warning in matrix(1:4, nrow = 2, ncol = 3): data length [4] is not a sub-
## multiple or multiple of the number of columns [3]
```

```r
dimnames(m)<-list(c("a","b"),c("c","d","e"))
m
```

```
##   c d e
## a 1 3 1
## b 2 4 2
```

###2) basic reading: read.table/dput/dget/dump/source/

```r
data<-read.table("foo.txt")
data
```

```
##       V1   V2
## 1   name type
## 2   Meow  Cat
## 3   Woof  Dog
## 4 Kakaka  Fox
```

```r
foo<-read.table(file="test.txt",header=TRUE,sep="\n",nrows=3)
foo
```

```
##                                                                                                                                             X.F48MJBB02HA5PZ_cs_nbp_rc.cs_nbp.32.57.sample.700033450.rbarcode.ACGTTCCAC.primer.V3.V5.subject.159470302.body_site.Saliva.center.WUGSC
## 1                                                                                                                                                                                                                                                         CCTACGGGAGGCAGCAGGGATGAGAT
## 2                                                                                                                                           >F48MJBB02I669X_cs_nbp_rc cs_nbp=32-305 sample=700033450 rbarcode=ACGTTCCAC primer=V3-V5 subject=159470302 body_site=Saliva center=WUGSC
## 3 CCTATCCCCTGTGTGCCTTGAGTATCGGAGGGGCAGGCGGAATTCCTAGTGTAGCGGTGAAATGCGTAGATATTAGGAAGAACACCGGTGGCGAAGGCGGCCTGCTGGACGAAAACTGACGTTGAGGCTCGAAGGCGTGGGGAGCAAGCAGGATTAGATACCCTGGTAGTCCACGCGGTAAACGATGAATACTAGGCGTTGGTGCCCCAAGGGCATCGGTGCCGTCGCAAACGCAATAAGTATTCCACCTGGGGAGTACGTTCGCAAGAATGAA
```

```r
# passing adata around by deparsing R object using dput
# and reading back using dget
y<-data.frame(a=1,b="a")
#dput(y)
dput(y,file="y.R") # actually creates physical y.R
new.y<-dget("y.R")
new.y
```

```
##   a b
## 1 1 a
```

```r
x<-"foo"
y<-data.frame(a=1, b="a")
dump(c("x","y"),file="data.R") # creates physical data.R
rm(x,y)
source("data.R")
y
```

```
##   a b
## 1 1 a
```

```r
x
```

```
## [1] "foo"
```

###3) basic connections: file/readLines/writeLines/url

```r
con<-file("HMP_16s_single_cell_MDA_from_fecal_specimens-short.txt","r")
x<-readLines(con,100)
x
```

```
## [1] ">1042139-140-141-142_A04_TIGR_WGACA01T1F15058_1042140_1122243671925_016_1122232824624 Trace of J:\\Environmental_Genomics\\Lasken lab\\Lasken Lab DNA Sequencing Log\\03-29-10 Sequencing Results - Fecal Combo sort\\TraceFiles-20100329131835\\1042139-140-141-142_A04_TIGR_WGACA01T1F15058_1042140_1122243671925_016_1122232824624.scf; length: 485; low quality 95; medium quality 145; high quality 245"
## [2] "ACTGCTAATACCGCATATGCCATGAACATCGCATGATGAAAATGGGAAAGGAGCAATCCG"                                                                                                                                                                                                                                                                                                                                                
## [3] "CTAATAGATGAGCTTGCGTCTGATTAACTAGTTGGTGTGGTAATGGCATACCAAGGTAAC"                                                                                                                                                                                                                                                                                                                                                
## [4] "GATCAGTAGCCGGACTGAGAGGTTGAACGGCCACATTGGGACTGAGATACGGCCCAGACT"                                                                                                                                                                                                                                                                                                                                                
## [5] "CCTACGGGAGGCAGCAGTCGGGAATATTGCGCAATGGAGGAAACTCTGACGCAGTGACGC"                                                                                                                                                                                                                                                                                                                                                
## [6] "CGCGTATAGGATGAAGGTTTTCGGATTGTAAACTATTGTCATTAGGGAAGATAAAAGACA"                                                                                                                                                                                                                                                                                                                                                
## [7] "GTACCTAAGGAGGAAGC"
```

```r
out<-file("test-output.txt","w")
writeLines(text = x,con = out)
close(con)
close(out)
con<-url("http://www.google.com","r")
x<-readLines(con)
```

```
## Warning in readLines(con): incomplete final line found on 'http://
## www.google.com'
```

```r
head(x,1)
```

```
## [1] "<!doctype html><html itemscope=\"\" itemtype=\"http://schema.org/WebPage\" lang=\"en\"><head><meta content=\"Search the world's information, including webpages, images, videos and more. Google has many special features to help you find exactly what you're looking for.\" name=\"description\"><meta content=\"noodp\" name=\"robots\"><meta content=\"text/html; charset=UTF-8\" http-equiv=\"Content-Type\"><meta content=\"/logos/doodles/2016/lunar-new-year-2016-5134827118395392-hp.jpg\" itemprop=\"image\"><meta content=\"Happy Lunar New Year! #GoogleDoodle\" property=\"og:description\"><meta content=\"http://www.google.com/logos/doodles/2016/lunar-new-year-2016-5134827118395392-thp.png\" property=\"og:image\"><meta content=\"500\" property=\"og:image:width\"><meta content=\"200\" property=\"og:image:height\"><title>Google</title><script>(function(){window.google={kEI:'-V-5Vr3lGISMjwOEkrW4CQ',kEXPI:'1350255,3700062,3700307,3700385,4028790,4029815,4031109,4032677,4033307,4036509,4036527,4038012,4039268,4039954,4042784,4042792,4043492,4044606,4045841,4046304,4048882,4049499,4049501,4049549,4049557,4050886,4050891,4050908,4051241,4051559,4051596,4051714,4052304,4052781,4054117,4054224,4054284,4054513,4055744,4056038,4056162,4056590,4056606,4057170,4057586,4057836,4057920,4058004,4058033,4058117,4058337,4058544,4059275,4059318,4059328,4059359,8300096,8300273,8300310,8300317,8502095,8502315,8502347,8502691,8502985,8503109,8503131,8503212,8503331,8503332,10200083',authuser:0,kscs:'c9c918f0_24'};google.kHL='en';})();(function(){google.lc=[];google.li=0;google.getEI=function(a){for(var b;a&&(!a.getAttribute||!(b=a.getAttribute(\"eid\")));)a=a.parentNode;return b||google.kEI};google.getLEI=function(a){for(var b=null;a&&(!a.getAttribute||!(b=a.getAttribute(\"leid\")));)a=a.parentNode;return b};google.https=function(){return\"https:\"==window.location.protocol};google.ml=function(){return null};google.wl=function(a,b){try{google.ml(Error(a),!1,b)}catch(d){}};google.time=function(){return(new Date).getTime()};google.log=function(a,b,d,e,g){a=google.logUrl(a,b,d,e,g);if(\"\"!=a){b=new Image;var c=google.lc,f=google.li;c[f]=b;b.onerror=b.onload=b.onabort=function(){delete c[f]};window.google&&window.google.vel&&window.google.vel.lu&&window.google.vel.lu(a);b.src=a;google.li=f+1}};google.logUrl=function(a,b,d,e,g){var c=\"\",f=google.ls||\"\";if(!d&&-1==b.search(\"&ei=\")){var h=google.getEI(e),c=\"&ei=\"+h;-1==b.search(\"&lei=\")&&((e=google.getLEI(e))?c+=\"&lei=\"+e:h!=google.kEI&&(c+=\"&lei=\"+google.kEI))}a=d||\"/\"+(g||\"gen_204\")+\"?atyp=i&ct=\"+a+\"&cad=\"+b+c+f+\"&zx=\"+google.time();/^http:/i.test(a)&&google.https()&&(google.ml(Error(\"a\"),!1,{src:a,glmm:1}),a=\"\");return a};google.y={};google.x=function(a,b){google.y[a.id]=[a,b];return!1};google.load=function(a,b,d){google.x({id:a+k++},function(){google.load(a,b,d)})};var k=0;})();var _gjwl=location;function _gjuc(){var a=_gjwl.href.indexOf(\"#\");if(0<=a&&(a=_gjwl.href.substring(a),0<a.indexOf(\"&q=\")||0<=a.indexOf(\"#q=\"))&&(a=a.substring(1),-1==a.indexOf(\"#\"))){for(var d=0;d<a.length;){var b=d;\"&\"==a.charAt(b)&&++b;var c=a.indexOf(\"&\",b);-1==c&&(c=a.length);b=a.substring(b,c);if(0==b.indexOf(\"fp=\"))a=a.substring(0,d)+a.substring(c,a.length),c=d;else if(\"cad=h\"==b)return 0;d=c}_gjwl.href=\"/search?\"+a+\"&cad=h\";return 1}return 0}"
```

```r
close(con)
```

###4) basic subsetting: vector/list/matrix/partial-matching/removing-NA-values

```r
x<-c("a","b","c","d","e")
x[1:4]
```

```
## [1] "a" "b" "c" "d"
```

```r
x[x>"b"]
```

```
## [1] "c" "d" "e"
```

```r
y<-list(foo=1:4,bar=c(0.6,0.4,0.2),baz=TRUE,bad=list(4,3,2,1))
y[[2]]
```

```
## [1] 0.6 0.4 0.2
```

```r
y$bar
```

```
## [1] 0.6 0.4 0.2
```

```r
y[["bar"]]
```

```
## [1] 0.6 0.4 0.2
```

```r
y[["bad"]][[3]]
```

```
## [1] 2
```

```r
m<-matrix(1:6,2,3)
m
```

```
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
```

```r
m[1,2] #m[row,col]
```

```
## [1] 3
```

```r
m[1,] #m entire row=1
```

```
## [1] 1 3 5
```

```r
m[1,,drop=FALSE] # if drop=FALSE, the 1x1 matrix is maintained
```

```
##      [,1] [,2] [,3]
## [1,]    1    3    5
```

```r
x<-list(aardvark=1:5)
x[["aard",exact=FALSE]] # if exact=FALSE, partial matching is ok
```

```
## [1] 1 2 3 4 5
```

```r
x<-c(1,2,NA,4,NA,5)
x[!is.na(x)]
```

```
## [1] 1 2 4 5
```

```r
y<-c("a","b",NA,"d",NA,NA)
x[complete.cases(x,y)]
```

```
## [1] 1 2 4
```

```r
y[complete.cases(x,y)]
```

```
## [1] "a" "b" "d"
```

```r
airquality[1:10,]
```

```
##    Ozone Solar.R Wind Temp Month Day
## 1     41     190  7.4   67     5   1
## 2     36     118  8.0   72     5   2
## 3     12     149 12.6   74     5   3
## 4     18     313 11.5   62     5   4
## 5     NA      NA 14.3   56     5   5
## 6     28      NA 14.9   66     5   6
## 7     23     299  8.6   65     5   7
## 8     19      99 13.8   59     5   8
## 9      8      19 20.1   61     5   9
## 10    NA     194  8.6   69     5  10
```

```r
airquality[complete.cases(airquality),][1:10,]
```

```
##    Ozone Solar.R Wind Temp Month Day
## 1     41     190  7.4   67     5   1
## 2     36     118  8.0   72     5   2
## 3     12     149 12.6   74     5   3
## 4     18     313 11.5   62     5   4
## 7     23     299  8.6   65     5   7
## 8     19      99 13.8   59     5   8
## 9      8      19 20.1   61     5   9
## 12    16     256  9.7   69     5  12
## 13    11     290  9.2   66     5  13
## 14    14     274 10.9   68     5  14
```

###5) basic vectorized operations

```r
x<-1:4;y<-6:9
x*y
```

```
## [1]  6 14 24 36
```

```r
x<-matrix(1:4,2,2);y<-matrix(rep(10,4),2,2)
x*y # element-wise multiplication
```

```
##      [,1] [,2]
## [1,]   10   30
## [2,]   20   40
```

```r
x%*%y # true matrix multiplication
```

```
##      [,1] [,2]
## [1,]   40   40
## [2,]   60   60
```

```r
y%*%x
```

```
##      [,1] [,2]
## [1,]   30   70
## [2,]   30   70
```

###6) basic control structures: if-else/for/while/repeat

```r
x<-5;y<-7
if(x>y) {
    print("x is bigger than y")
} else if(x<y) {
    print("y is bigger than x")
} else {
    print("x and y are same")
}
```

```
## [1] "y is bigger than x"
```

```r
z<- if(x>3) {
    10
} else {
    30
}
z
```

```
## [1] 10
```

```r
for(i in 4:1) {
    print(i)
}
```

```
## [1] 4
## [1] 3
## [1] 2
## [1] 1
```

```r
x<-c("d","c","b","a")
for(i in 1:4){ print(x[i]) } # 1 of 3 ways to achieve similar result
```

```
## [1] "d"
## [1] "c"
## [1] "b"
## [1] "a"
```

```r
for(i in seq_along(x)){ print(x[i]) } # 1 of 3 ways to achieve similar result
```

```
## [1] "d"
## [1] "c"
## [1] "b"
## [1] "a"
```

```r
for(letter in x) { print(letter) } # 1 of 3 ways to achieve similar result
```

```
## [1] "d"
## [1] "c"
## [1] "b"
## [1] "a"
```

```r
x<-matrix(1:6,2,3)
x
```

```
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
```

```r
# nested for-loop
for(i in seq_len(nrow(x))) {
    for(j in seq_len(ncol(x))) {
        print(x[i,j])
    }
}
```

```
## [1] 1
## [1] 3
## [1] 5
## [1] 2
## [1] 4
## [1] 6
```

```r
count<-0
while(count<10) {
    print(count)
    count<-count+1
}
```

```
## [1] 0
## [1] 1
## [1] 2
## [1] 3
## [1] 4
## [1] 5
## [1] 6
## [1] 7
## [1] 8
## [1] 9
```

```r
z<-5
while(z>=3 && z<=10) {
    print(z)
    coin<-rbinom(1,1,0.5)
    if(coin==1) { # random coin toss-up
        z<-z+1
    } else {
        z<-z-1
    }
}
```

```
## [1] 5
## [1] 6
## [1] 5
## [1] 4
## [1] 3
```

```r
x0<-1
i<-0
repeat{ #infinite while(TRUE) loop
    i<-i+1
    x1<-rnorm(1)
    if(abs(x1-x0)>6) {
        print(abs(x1-x0))
        print(i)
        break
    } else {
        x0<-x1
    }
}
```

```
## [1] 6.126088
## [1] 16405
```

```r
for(i in 1:100) {
    if(i<=90) { # skip from 1 to 90
        next
    }
    print(i)
}
```

```
## [1] 91
## [1] 92
## [1] 93
## [1] 94
## [1] 95
## [1] 96
## [1] 97
## [1] 98
## [1] 99
## [1] 100
```

###7) basic functions

```r
above<-function(x,n) {
    use<-x>n
    x[use]
}
above(1:20,12)
```

```
## [1] 13 14 15 16 17 18 19 20
```

```r
colmeans<-function(y) {
    nc<-ncol(y)
    means<-numeric(nc)
    for(i in 1:nc){
        #means[i]<-mean(y[,i])
        means[i]<-mean(y[,i][!is.na(y[,i])])
    }
    means
}
colmeans(airquality)
```

```
## [1]  42.129310 185.931507   9.957516  77.882353   6.993464  15.803922
```
